<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Handover Protocol v2</title>
    
    <!-- jsPDF and jsPDF-AutoTable for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        
        .header {
            background: #8b0000;
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .back-link {
            display: inline-block;
            margin-bottom: 15px;
            color: white;
            text-decoration: none;
            opacity: 0.9;
        }
        
        .back-link:hover {
            opacity: 1;
        }
        
        .content {
            padding: 40px;
        }
        
        .instructions {
            background: #e3f2fd;
            border-left: 4px solid #2196F3;
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 5px;
        }
        
        .instructions h2 {
            color: #1976d2;
            font-size: 18px;
            margin-bottom: 15px;
        }
        
        .instructions ol {
            margin-left: 20px;
        }
        
        .instructions li {
            margin-bottom: 8px;
        }
        
        .info-box {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
            font-size: 14px;
        }
        
        .section {
            margin-bottom: 40px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .section-header {
            background: #f5f5f5;
            padding: 15px 20px;
            border-bottom: 2px solid #8b0000;
        }
        
        .section-title {
            font-size: 20px;
            color: #8b0000;
            font-weight: 600;
        }
        
        .section-content {
            padding: 20px;
        }
        
        .item {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .item-name {
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
            font-size: 15px;
        }
        
        .checkbox-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 10px;
        }
        
        .checkbox-label {
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 8px 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            transition: all 0.3s;
            background: white;
            font-size: 14px;
        }
        
        .checkbox-label:hover {
            border-color: #667eea;
            background: #f8f9ff;
        }
        
        .checkbox-label.checked {
            border-color: #8b0000;
            background: #fff5f5;
        }
        
        input[type="radio"] {
            margin-right: 8px;
            cursor: pointer;
            width: 18px;
            height: 18px;
        }
        
        .remarks {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            min-height: 60px;
            resize: vertical;
            font-family: inherit;
            margin-bottom: 10px;
        }
        
        .remarks:focus,
        input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .photo-upload-section {
            margin-top: 15px;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 5px;
            border: 2px dashed #ddd;
        }
        
        .photo-upload-label {
            display: block;
            text-align: center;
            padding: 20px;
            background: white;
            border: 2px dashed #667eea;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .photo-upload-label:hover {
            background: #f8f9ff;
            border-color: #8b0000;
        }
        
        .photo-upload-label.has-files {
            border-color: #4caf50;
            background: #f1f8f4;
        }
        
        input[type="file"] {
            display: none;
        }
        
        .photo-preview-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        
        .photo-preview {
            position: relative;
            aspect-ratio: 1;
            border-radius: 5px;
            overflow: hidden;
            border: 2px solid #ddd;
        }
        
        .photo-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .photo-preview .remove-photo {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(255, 0, 0, 0.8);
            color: white;
            border: none;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            cursor: pointer;
            font-size: 16px;
            line-height: 1;
        }
        
        .signature-section {
            background: #f9f9f9;
            padding: 30px;
            border-radius: 8px;
            margin-top: 30px;
        }
        
        .signature-section h3 {
            color: #8b0000;
            margin-bottom: 20px;
            font-size: 20px;
        }
        
        .signature-group {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .signature-field {
            display: flex;
            flex-direction: column;
        }
        
        .signature-field label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
        }
        
        .signature-field input[type="text"],
        .signature-field input[type="email"],
        .signature-field input[type="date"] {
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }
        
        .signature-canvas-container {
            border: 2px solid #ddd;
            border-radius: 5px;
            background: white;
            margin-bottom: 20px;
        }
        
        .signature-canvas-label {
            background: #f5f5f5;
            padding: 10px 15px;
            font-weight: 600;
            color: #333;
            border-bottom: 1px solid #ddd;
        }
        
        .signature-canvas {
            display: block;
            width: 100%;
            height: 150px;
            cursor: crosshair;
            touch-action: none;
        }
        
        .signature-buttons {
            padding: 10px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #f5f5f5;
            border-top: 1px solid #ddd;
        }
        
        .clear-signature {
            background: #f44336;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .clear-signature:hover {
            background: #d32f2f;
        }
        
        .submit-section {
            text-align: center;
            margin-top: 30px;
        }
        
        .submit-btn {
            background: #8b0000;
            color: white;
            padding: 15px 50px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s;
            width: 100%;
            max-width: 400px;
            margin: 10px auto;
            display: block;
        }
        
        .submit-btn:hover:not(:disabled) {
            background: #660000;
        }
        
        .submit-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        .progress-indicator {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background: #fff3e0;
            border-radius: 5px;
            border-left: 4px solid #ff9800;
        }
        
        .success-message {
            display: none;
            margin-top: 15px;
            padding: 20px;
            background: #e8f5e9;
            border-radius: 5px;
            border-left: 4px solid #4caf50;
            color: #2e7d32;
        }
        
        @media (max-width: 768px) {
            .content {
                padding: 20px;
            }
            
            .checkbox-group {
                flex-direction: column;
                gap: 10px;
            }
            
            .signature-canvas {
                height: 120px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="index.html" class="back-link">‚Üê Back to Language Selection</a>
            <h1>üè† Handover Protocol</h1>
            <p>Documentation of Condition at Handover</p>
        </div>
        
        <div class="content">
            <div class="instructions">
                <h2>üìã Instructions</h2>
                <ol>
                    <li>Fill out all fields</li>
                    <li>Take photos (automatically compressed)</li>
                    <li>Sign digitally with your finger</li>
                    <li>Click "Create & Download PDF"</li>
                    <li>Send the PDF via email to all parties</li>
                </ol>
            </div>

            <div class="info-box">
                <strong>‚ú® New:</strong> Digital signature with finger ‚Ä¢ Auto-compression of photos ‚Ä¢ PDF download with all data
            </div>

            <form id="handoverForm">
                
                <!-- OBJEKTDATEN -->
                <div class="section">
                    <div class="section-header">
                        <h2 class="section-title">üè¢ Property Details</h2>
                    </div>
                    <div class="section-content">
                        <div class="item">
                            <div class="item-name">Address *</div>
                            <textarea class="remarks" id="property_address" placeholder="Street, Number, Postal Code, City&#10;z.B. Engadinerstr. 36, 81475 Munich" required style="min-height: 80px;"></textarea>
                        </div>

                        <div class="item">
                            <div class="item-name">Property Type *</div>
                            <div class="checkbox-group">
                                <label class="checkbox-label">
                                    <input type="radio" name="property_type" value="Entire Apartment" onchange="updateRadio(this); toggleRoomNumber(false)" required>
                                    <span>Entire Apartment</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="radio" name="property_type" value="Room" onchange="updateRadio(this); toggleRoomNumber(true)">
                                    <span>Room</span>
                                </label>
                            </div>
                            <div id="room_number_field" style="display: none; margin-top: 15px;">
                                <textarea class="remarks" id="room_number" placeholder="Roomnummer / Bezeichnung&#10;z.B. Room 1, Room 2A, etc." style="min-height: 60px;"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ZIMMER -->
                <div class="section">
                    <div class="section-header">
                        <h2 class="section-title">üö™ Room</h2>
                    </div>
                    <div class="section-content">
                        <div class="item">
                            <div class="item-name">Walls</div>
                            <div class="checkbox-group">
                                <label class="checkbox-label">
                                    <input type="radio" name="room_walls" value="Excellent" onchange="updateRadio(this)">
                                    <span>Excellent</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="radio" name="room_walls" value="Minor Wear" onchange="updateRadio(this)">
                                    <span>Minor Wear</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="radio" name="room_walls" value="Damaged" onchange="updateRadio(this)">
                                    <span>Damaged</span>
                                </label>
                            </div>
                            <textarea class="remarks" id="room_walls_remarks" placeholder="Remarks..."></textarea>
                            <div class="photo-upload-section">
                                <label class="photo-upload-label" id="label_room_walls">
                                    üì∑ Upload photos of walls
                                    <input type="file" accept="image/*" multiple onchange="handlePhotoUpload(this, 'room_walls')">
                                </label>
                                <div class="photo-preview-container" id="preview_room_walls"></div>
                            </div>
                        </div>

                        <div class="item">
                            <div class="item-name">Floor</div>
                            <div class="checkbox-group">
                                <label class="checkbox-label">
                                    <input type="radio" name="room_floor" value="Excellent" onchange="updateRadio(this)">
                                    <span>Excellent</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="radio" name="room_floor" value="Minor Wear" onchange="updateRadio(this)">
                                    <span>Minor Wear</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="radio" name="room_floor" value="Damaged" onchange="updateRadio(this)">
                                    <span>Damaged</span>
                                </label>
                            </div>
                            <textarea class="remarks" id="room_floor_remarks" placeholder="Remarks..."></textarea>
                            <div class="photo-upload-section">
                                <label class="photo-upload-label" id="label_room_floor">
                                    üì∑ Upload photos of floor
                                    <input type="file" accept="image/*" multiple onchange="handlePhotoUpload(this, 'room_floor')">
                                </label>
                                <div class="photo-preview-container" id="preview_room_floor"></div>
                            </div>
                        </div>

                        <div class="item">
                            <div class="item-name">Windows</div>
                            <div class="checkbox-group">
                                <label class="checkbox-label">
                                    <input type="radio" name="room_windows" value="Excellent" onchange="updateRadio(this)">
                                    <span>Excellent</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="radio" name="room_windows" value="Minor Wear" onchange="updateRadio(this)">
                                    <span>Minor Wear</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="radio" name="room_windows" value="Damaged" onchange="updateRadio(this)">
                                    <span>Damaged</span>
                                </label>
                            </div>
                            <textarea class="remarks" id="room_windows_remarks" placeholder="Remarks..."></textarea>
                            <div class="photo-upload-section">
                                <label class="photo-upload-label" id="label_room_windows">
                                    üì∑ Upload photos of windows
                                    <input type="file" accept="image/*" multiple onchange="handlePhotoUpload(this, 'room_windows')">
                                </label>
                                <div class="photo-preview-container" id="preview_room_windows"></div>
                            </div>
                        </div>

                        <div class="item">
                            <div class="item-name">Cleanliness</div>
                            <div class="checkbox-group">
                                <label class="checkbox-label">
                                    <input type="radio" name="room_cleanliness" value="Excellent" onchange="updateRadio(this)">
                                    <span>Excellent</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="radio" name="room_cleanliness" value="Slightly Dirty" onchange="updateRadio(this)">
                                    <span>Slightly Dirty</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="radio" name="room_cleanliness" value="Very Dirty" onchange="updateRadio(this)">
                                    <span>Very Dirty</span>
                                </label>
                            </div>
                            <textarea class="remarks" id="room_cleanliness_remarks" placeholder="Remarks..."></textarea>
                        </div>
                    </div>
                </div>

                <!-- M√ñBEL -->
                <div class="section">
                    <div class="section-header">
                        <h2 class="section-title">üõãÔ∏è Furniture</h2>
                    </div>
                    <div class="section-content">
                        <div class="item">
                            <div class="item-name">Bed</div>
                            <div class="checkbox-group">
                                <label class="checkbox-label">
                                    <input type="radio" name="furniture_bed" value="Excellent" onchange="updateRadio(this)">
                                    <span>Excellent</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="radio" name="furniture_bed" value="Minor Wear" onchange="updateRadio(this)">
                                    <span>Minor Wear</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="radio" name="furniture_bed" value="Damaged" onchange="updateRadio(this)">
                                    <span>Damaged</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="radio" name="furniture_bed" value="Missing" onchange="updateRadio(this)">
                                    <span>Missing</span>
                                </label>
                            </div>
                            <textarea class="remarks" id="furniture_bed_remarks" placeholder="Remarks..."></textarea>
                            <div class="photo-upload-section">
                                <label class="photo-upload-label" id="label_furniture_bed">
                                    üì∑ Upload photos of bed
                                    <input type="file" accept="image/*" multiple onchange="handlePhotoUpload(this, 'furniture_bed')">
                                </label>
                                <div class="photo-preview-container" id="preview_furniture_bed"></div>
                            </div>
                        </div>

                        <div class="item">
                            <div class="item-name">Desk</div>
                            <div class="checkbox-group">
                                <label class="checkbox-label">
                                    <input type="radio" name="furniture_desk" value="Excellent" onchange="updateRadio(this)">
                                    <span>Excellent</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="radio" name="furniture_desk" value="Minor Wear" onchange="updateRadio(this)">
                                    <span>Minor Wear</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="radio" name="furniture_desk" value="Damaged" onchange="updateRadio(this)">
                                    <span>Damaged</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="radio" name="furniture_desk" value="Missing" onchange="updateRadio(this)">
                                    <span>Missing</span>
                                </label>
                            </div>
                            <textarea class="remarks" id="furniture_desk_remarks" placeholder="Remarks..."></textarea>
                            <div class="photo-upload-section">
                                <label class="photo-upload-label" id="label_furniture_desk">
                                    üì∑ Upload photos of desk
                                    <input type="file" accept="image/*" multiple onchange="handlePhotoUpload(this, 'furniture_desk')">
                                </label>
                                <div class="photo-preview-container" id="preview_furniture_desk"></div>
                            </div>
                        </div>

                        <div class="item">
                            <div class="item-name">Chair</div>
                            <div class="checkbox-group">
                                <label class="checkbox-label">
                                    <input type="radio" name="furniture_chair" value="Excellent" onchange="updateRadio(this)">
                                    <span>Excellent</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="radio" name="furniture_chair" value="Minor Wear" onchange="updateRadio(this)">
                                    <span>Minor Wear</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="radio" name="furniture_chair" value="Damaged" onchange="updateRadio(this)">
                                    <span>Damaged</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="radio" name="furniture_chair" value="Missing" onchange="updateRadio(this)">
                                    <span>Missing</span>
                                </label>
                            </div>
                            <textarea class="remarks" id="furniture_chair_remarks" placeholder="Remarks..."></textarea>
                            <div class="photo-upload-section">
                                <label class="photo-upload-label" id="label_furniture_chair">
                                    üì∑ Upload photos of chair
                                    <input type="file" accept="image/*" multiple onchange="handlePhotoUpload(this, 'furniture_chair')">
                                </label>
                                <div class="photo-preview-container" id="preview_furniture_chair"></div>
                            </div>
                        </div>

                        <div class="item">
                            <div class="item-name">Wardrobe</div>
                            <div class="checkbox-group">
                                <label class="checkbox-label">
                                    <input type="radio" name="furniture_wardrobe" value="Excellent" onchange="updateRadio(this)">
                                    <span>Excellent</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="radio" name="furniture_wardrobe" value="Minor Wear" onchange="updateRadio(this)">
                                    <span>Minor Wear</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="radio" name="furniture_wardrobe" value="Damaged" onchange="updateRadio(this)">
                                    <span>Damaged</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="radio" name="furniture_wardrobe" value="Missing" onchange="updateRadio(this)">
                                    <span>Missing</span>
                                </label>
                            </div>
                            <textarea class="remarks" id="furniture_wardrobe_remarks" placeholder="Remarks..."></textarea>
                            <div class="photo-upload-section">
                                <label class="photo-upload-label" id="label_furniture_wardrobe">
                                    üì∑ Upload photos of wardrobe
                                    <input type="file" accept="image/*" multiple onchange="handlePhotoUpload(this, 'furniture_wardrobe')">
                                </label>
                                <div class="photo-preview-container" id="preview_furniture_wardrobe"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- GEMEINSCHAFTSBEREICHE -->
                <div class="section">
                    <div class="section-header">
                        <h2 class="section-title">üë• Common Areas</h2>
                    </div>
                    <div class="section-content">
                        <div class="item">
                            <div class="item-name">Kitchen</div>
                            <div class="checkbox-group">
                                <label class="checkbox-label">
                                    <input type="radio" name="common_kitchen" value="Excellent" onchange="updateRadio(this)">
                                    <span>Excellent</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="radio" name="common_kitchen" value="Minor Wear" onchange="updateRadio(this)">
                                    <span>Minor Wear</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="radio" name="common_kitchen" value="Damaged" onchange="updateRadio(this)">
                                    <span>Damaged</span>
                                </label>
                            </div>
                            <textarea class="remarks" id="common_kitchen_remarks" placeholder="Remarks..."></textarea>
                            <div class="photo-upload-section">
                                <label class="photo-upload-label" id="label_common_kitchen">
                                    üì∑ Upload photos of kitchen
                                    <input type="file" accept="image/*" multiple onchange="handlePhotoUpload(this, 'common_kitchen')">
                                </label>
                                <div class="photo-preview-container" id="preview_common_kitchen"></div>
                            </div>
                        </div>

                        <div class="item">
                            <div class="item-name">Bathroom</div>
                            <div class="checkbox-group">
                                <label class="checkbox-label">
                                    <input type="radio" name="common_bathroom" value="Excellent" onchange="updateRadio(this)">
                                    <span>Excellent</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="radio" name="common_bathroom" value="Minor Wear" onchange="updateRadio(this)">
                                    <span>Minor Wear</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="radio" name="common_bathroom" value="Damaged" onchange="updateRadio(this)">
                                    <span>Damaged</span>
                                </label>
                            </div>
                            <textarea class="remarks" id="common_bathroom_remarks" placeholder="Remarks..."></textarea>
                            <div class="photo-upload-section">
                                <label class="photo-upload-label" id="label_common_bathroom">
                                    üì∑ Upload photos of bathroom
                                    <input type="file" accept="image/*" multiple onchange="handlePhotoUpload(this, 'common_bathroom')">
                                </label>
                                <div class="photo-preview-container" id="preview_common_bathroom"></div>
                            </div>
                        </div>

                        <div class="item">
                            <div class="item-name">Hallway</div>
                            <div class="checkbox-group">
                                <label class="checkbox-label">
                                    <input type="radio" name="common_hallway" value="Excellent" onchange="updateRadio(this)">
                                    <span>Excellent</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="radio" name="common_hallway" value="Minor Wear" onchange="updateRadio(this)">
                                    <span>Minor Wear</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="radio" name="common_hallway" value="Damaged" onchange="updateRadio(this)">
                                    <span>Damaged</span>
                                </label>
                            </div>
                            <textarea class="remarks" id="common_hallway_remarks" placeholder="Remarks..."></textarea>
                            <div class="photo-upload-section">
                                <label class="photo-upload-label" id="label_common_hallway">
                                    üì∑ Upload photos of hallway
                                    <input type="file" accept="image/*" multiple onchange="handlePhotoUpload(this, 'common_hallway')">
                                </label>
                                <div class="photo-preview-container" id="preview_common_hallway"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SCHL√úSSEL -->
                <div class="section">
                    <div class="section-header">
                        <h2 class="section-title">üîë Keys</h2>
                    </div>
                    <div class="section-content">
                        <div class="item">
                            <div class="item-name">Anzahl √ºbergebener Keys</div>
                            <textarea class="remarks" id="keys_details" placeholder="Z.B. 2x apartment keys, 1x mailbox key, 1x front door key..."></textarea>
                            <div class="photo-upload-section">
                                <label class="photo-upload-label" id="label_keys">
                                    üì∑ Photo of all keys
                                    <input type="file" accept="image/*" multiple onchange="handlePhotoUpload(this, 'keys')">
                                </label>
                                <div class="photo-preview-container" id="preview_keys"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Z√ÑHLERST√ÑNDE -->
                <div class="section">
                    <div class="section-header">
                        <h2 class="section-title">‚ö° Meter Readings</h2>
                    </div>
                    <div class="section-content">
                        <div class="item">
                            <div class="item-name">Electricity Meter</div>
                            <textarea class="remarks" id="meter_electricity" placeholder="Enter meter reading..."></textarea>
                            <div class="photo-upload-section">
                                <label class="photo-upload-label" id="label_meter_electricity">
                                    üì∑ Photo of electricity meter
                                    <input type="file" accept="image/*" onchange="handlePhotoUpload(this, 'meter_electricity')">
                                </label>
                                <div class="photo-preview-container" id="preview_meter_electricity"></div>
                            </div>
                        </div>

                        <div class="item">
                            <div class="item-name">Water Meter</div>
                            <textarea class="remarks" id="meter_water" placeholder="Warmwasser / Kaltwasser Meter Readings..."></textarea>
                            <div class="photo-upload-section">
                                <label class="photo-upload-label" id="label_meter_water">
                                    üì∑ Photo of water meter
                                    <input type="file" accept="image/*" onchange="handlePhotoUpload(this, 'meter_water')">
                                </label>
                                <div class="photo-preview-container" id="preview_meter_water"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- E-MAIL & UNTERSCHRIFTEN -->
                <div class="signature-section">
                    <h3>üìß E-Mail-Addressn f√ºr Versand</h3>
                    <div class="info-box">
                        Please enter all email addresses. The PDF should be sent to these addresses.
                    </div>
                    
                    <div class="signature-group">
                        <div class="signature-field">
                            <label>Email Outgoing Tenant: *</label>
                            <input type="email" id="email_outgoing" required placeholder="tenant.old@example.com">
                        </div>
                        <div class="signature-field">
                            <label>Email Incoming Tenant: *</label>
                            <input type="email" id="email_incoming" required placeholder="tenant.new@example.com">
                        </div>
                        <div class="signature-field">
                            <label>Email Landlord:</label>
                            <input type="email" id="email_landlord" value="chriskranz88@googlemail.com" placeholder="landlord@example.com">
                        </div>
                    </div>

                    <h3>‚úçÔ∏è Digital Signatures</h3>
                    <div class="info-box">
                        Please sign with your finger on the gray field. Works best on smartphone!
                    </div>
                    
                    <div class="signature-canvas-container">
                        <div class="signature-canvas-label">Signature Outgoing Tenant</div>
                        <canvas id="signature_outgoing" class="signature-canvas"></canvas>
                        <div class="signature-buttons">
                            <button type="button" class="clear-signature" onclick="clearSignature('signature_outgoing')">Clear</button>
                            <input type="text" placeholder="Name" id="name_outgoing" required style="flex: 1; margin-left: 10px; padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                        </div>
                    </div>

                    <div class="signature-canvas-container">
                        <div class="signature-canvas-label">Signature Incoming Tenant</div>
                        <canvas id="signature_incoming" class="signature-canvas"></canvas>
                        <div class="signature-buttons">
                            <button type="button" class="clear-signature" onclick="clearSignature('signature_incoming')">Clear</button>
                            <input type="text" placeholder="Name" id="name_incoming" required style="flex: 1; margin-left: 10px; padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                        </div>
                    </div>

                    <div class="signature-field">
                        <label>Handover Date: *</label>
                        <input type="date" id="handover_date" required>
                    </div>
                </div>

                <!-- SUBMIT -->
                <div class="submit-section">
                    <button type="button" class="submit-btn" id="generatePdfBtn" onclick="generateAndDownloadPDF()">
                        üìÑ Create & Download PDF
                    </button>
                    <div class="progress-indicator" id="progressIndicator">
                        ‚è≥ Creating PDF... Please wait...
                    </div>
                    <div class="success-message" id="successMessage">
                        ‚úÖ PDF successfully created and downloaded!<br>
                        <strong>Next step:</strong> Send the PDF via email to:<br>
                        <span id="emailList"></span>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Store all data globally
        const formData = {
            photos: {},
            signatures: {}
        };
        
        // Signature Pad Setup
        function initializeSignaturePad(canvasId) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            
            // Set canvas size
            canvas.width = canvas.offsetWidth;
            canvas.height = 150;
            
            // Fill with white background
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            let isDrawing = false;
            let lastX = 0;
            let lastY = 0;
            
            function getCoordinates(e) {
                const rect = canvas.getBoundingClientRect();
                const clientX = e.clientX || (e.touches && e.touches[0].clientX);
                const clientY = e.clientY || (e.touches && e.touches[0].clientY);
                return {
                    x: clientX - rect.left,
                    y: clientY - rect.top
                };
            }
            
            function startDrawing(e) {
                isDrawing = true;
                const coords = getCoordinates(e);
                lastX = coords.x;
                lastY = coords.y;
                e.preventDefault();
            }
            
            function draw(e) {
                if (!isDrawing) return;
                e.preventDefault();
                
                const coords = getCoordinates(e);
                
                ctx.beginPath();
                ctx.moveTo(lastX, lastY);
                ctx.lineTo(coords.x, coords.y);
                ctx.strokeStyle = '#000000';
                ctx.lineWidth = 2;
                ctx.lineCap = 'round';
                ctx.lineJoin = 'round';
                ctx.stroke();
                
                lastX = coords.x;
                lastY = coords.y;
            }
            
            function stopDrawing() {
                isDrawing = false;
            }
            
            // Mouse events
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseout', stopDrawing);
            
            // Touch events for mobile
            canvas.addEventListener('touchstart', startDrawing, { passive: false });
            canvas.addEventListener('touchmove', draw, { passive: false });
            canvas.addEventListener('touchend', stopDrawing);
            canvas.addEventListener('touchcancel', stopDrawing);
        }
        
        function clearSignature(canvasId) {
            const canvas = document.getElementById(canvasId);
            const ctx = canvas.getContext('2d');
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        }
        
        // Initialize signature pads on load
        window.addEventListener('load', function() {
            initializeSignaturePad('signature_outgoing');
            initializeSignaturePad('signature_incoming');
            
            // Set today's date as default
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('handover_date').value = today;
        });
        
        // Photo handling with compression
        function compressImage(file, maxSizeMB = 1) {
            return new Promise((resolve) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = new Image();
                    img.onload = function() {
                        const canvas = document.createElement('canvas');
                        let width = img.width;
                        let height = img.height;
                        
                        // Resize if too large
                        const maxDimension = 1600;
                        if (width > maxDimension || height > maxDimension) {
                            if (width > height) {
                                height = (height / width) * maxDimension;
                                width = maxDimension;
                            } else {
                                width = (width / height) * maxDimension;
                                height = maxDimension;
                            }
                        }
                        
                        canvas.width = width;
                        canvas.height = height;
                        
                        const ctx = canvas.getContext('2d');
                        ctx.fillStyle = '#ffffff';
                        ctx.fillRect(0, 0, width, height);
                        ctx.drawImage(img, 0, 0, width, height);
                        
                        // Compress to JPEG
                        const dataUrl = canvas.toDataURL('image/jpeg', 0.8);
                        resolve(dataUrl);
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(file);
            });
        }
        
        async function handlePhotoUpload(input, category) {
            const files = Array.from(input.files);
            const label = document.getElementById(`label_${category}`);
            const previewContainer = document.getElementById(`preview_${category}`);
            
            if (files.length === 0) return;
            
            label.classList.add('has-files');
            label.innerHTML = `‚è≥ ${files.length} photo(s) being compressed...`;
            
            // Compress photos
            const compressedDataUrls = [];
            for (const file of files) {
                const compressed = await compressImage(file);
                compressedDataUrls.push(compressed);
            }
            
            formData.photos[category] = compressedDataUrls;
            label.innerHTML = `‚úÖ ${compressedDataUrls.length} photo(s) compressed`;
            
            // Show previews
            previewContainer.innerHTML = '';
            compressedDataUrls.forEach((dataUrl, index) => {
                const preview = document.createElement('div');
                preview.className = 'photo-preview';
                preview.innerHTML = `
                    <img src="${dataUrl}" alt="Photo ${index + 1}">
                    <button type="button" class="remove-photo" onclick="removePhoto('${category}', ${index})">√ó</button>
                `;
                previewContainer.appendChild(preview);
            });
        }
        
        function removePhoto(category, index) {
            formData.photos[category].splice(index, 1);
            
            // Update preview
            const previewContainer = document.getElementById(`preview_${category}`);
            const label = document.getElementById(`label_${category}`);
            
            if (formData.photos[category].length === 0) {
                delete formData.photos[category];
                label.classList.remove('has-files');
                label.innerHTML = `üì∑ Upload photos`;
                previewContainer.innerHTML = '';
            } else {
                label.innerHTML = `‚úÖ ${formData.photos[category].length} photo(s) compressed`;
                previewContainer.innerHTML = '';
                formData.photos[category].forEach((dataUrl, idx) => {
                    const preview = document.createElement('div');
                    preview.className = 'photo-preview';
                    preview.innerHTML = `
                        <img src="${dataUrl}" alt="Photo ${idx + 1}">
                        <button type="button" class="remove-photo" onclick="removePhoto('${category}', ${idx})">√ó</button>
                    `;
                    previewContainer.appendChild(preview);
                });
            }
        }
        
        function toggleRoomNumber(show) {
            const field = document.getElementById('room_number_field');
            const input = document.getElementById('room_number');
            if (show) {
                field.style.display = 'block';
                input.required = true;
            } else {
                field.style.display = 'none';
                input.required = false;
                input.value = '';
            }
        }
        
        function updateRadio(radio) {
            const name = radio.name;
            const allRadios = document.querySelectorAll(`input[name="${name}"]`);
            allRadios.forEach(r => {
                if (r === radio && r.checked) {
                    r.parentElement.classList.add('checked');
                } else {
                    r.parentElement.classList.remove('checked');
                }
            });
        }
        
        function getFormValue(id) {
            const element = document.getElementById(id);
            if (!element) return '';
            if (element.tagName === 'TEXTAREA' || element.tagName === 'INPUT') {
                return element.value || '';
            }
            return '';
        }
        
        function getRadioValue(name) {
            const radio = document.querySelector(`input[name="${name}"]:checked`);
            return radio ? radio.value : 'Not specified';
        }
        
        async function generateAndDownloadPDF() {
            const btn = document.getElementById('generatePdfBtn');
            const progress = document.getElementById('progressIndicator');
            const success = document.getElementById('successMessage');
            
            // Validate
            const requiredFields = ['property_address', 'name_outgoing', 'name_incoming', 'handover_date', 
                                   'email_outgoing', 'email_incoming'];
            for (const fieldId of requiredFields) {
                const element = document.getElementById(fieldId);
                if (!element.value) {
                    alert('Please fill out all required fields!');
                    element.focus();
                    return;
                }
            }
            
            // Check signatures
            const sigOutgoing = document.getElementById('signature_outgoing');
            const sigIncoming = document.getElementById('signature_incoming');
            const ctxOut = sigOutgoing.getContext('2d');
            const ctxIn = sigIncoming.getContext('2d');
            
            // Check if canvas is blank (simple check)
            const blankCanvas = document.createElement('canvas');
            blankCanvas.width = sigOutgoing.width;
            blankCanvas.height = sigOutgoing.height;
            const blankCtx = blankCanvas.getContext('2d');
            blankCtx.fillStyle = '#ffffff';
            blankCtx.fillRect(0, 0, blankCanvas.width, blankCanvas.height);
            
            if (sigOutgoing.toDataURL() === blankCanvas.toDataURL() || 
                sigIncoming.toDataURL() === blankCanvas.toDataURL()) {
                alert('Please sign both signature fields!');
                return;
            }
            
            btn.disabled = true;
            progress.style.display = 'block';
            success.style.display = 'none';
            
            try {
                // Get jsPDF from window (loaded from CDN)
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                let yPosition = 20;
                const pageHeight = doc.internal.pageSize.height;
                const margin = 15;
                const contentWidth = doc.internal.pageSize.width - 2 * margin;
                
                // Helper function to add new page if needed
                function checkAddPage(neededSpace = 20) {
                    if (yPosition + neededSpace > pageHeight - 20) {
                        doc.addPage();
                        yPosition = 20;
                        return true;
                    }
                    return false;
                }
                
                // Title
                doc.setFontSize(20);
                doc.setTextColor(139, 0, 0);
                doc.text('Handover Protocol', margin, yPosition);
                yPosition += 10;
                
                doc.setFontSize(10);
                doc.setTextColor(100, 100, 100);
                doc.text('Documentation of Condition at Handover', margin, yPosition);
                yPosition += 15;
                
                // Section: Property Details
                doc.setFontSize(14);
                doc.setTextColor(139, 0, 0);
                doc.text('Property Details', margin, yPosition);
                yPosition += 8;
                
                doc.setFontSize(10);
                doc.setTextColor(0, 0, 0);
                doc.text(`Address: ${getFormValue('property_address')}`, margin, yPosition);
                yPosition += 6;
                doc.text(`Art: ${getRadioValue('property_type')}`, margin, yPosition);
                yPosition += 6;
                const roomNumber = getFormValue('room_number');
                if (roomNumber) {
                    doc.text(`Room: ${roomNumber}`, margin, yPosition);
                    yPosition += 6;
                }
                yPosition += 5;
                
                // Section: Room
                checkAddPage(30);
                doc.setFontSize(14);
                doc.setTextColor(139, 0, 0);
                doc.text('Room', margin, yPosition);
                yPosition += 8;
                
                doc.setFontSize(10);
                doc.setTextColor(0, 0, 0);
                
                const roomItems = [
                    { label: 'Walls', name: 'room_walls', remarks: 'room_walls_remarks' },
                    { label: 'Floor', name: 'room_floor', remarks: 'room_floor_remarks' },
                    { label: 'Windows', name: 'room_windows', remarks: 'room_windows_remarks' },
                    { label: 'Cleanliness', name: 'room_cleanliness', remarks: 'room_cleanliness_remarks' }
                ];
                
                for (const item of roomItems) {
                    checkAddPage(15);
                    doc.text(`‚Ä¢ ${item.label}: ${getRadioValue(item.name)}`, margin + 2, yPosition);
                    yPosition += 5;
                    const remarks = getFormValue(item.remarks);
                    if (remarks) {
                        doc.setFontSize(9);
                        doc.setTextColor(80, 80, 80);
                        const lines = doc.splitTextToSize(`  Remark: ${remarks}`, contentWidth - 5);
                        doc.text(lines, margin + 2, yPosition);
                        yPosition += lines.length * 4;
                        doc.setFontSize(10);
                        doc.setTextColor(0, 0, 0);
                    }
                    
                    // Add photos if available
                    if (formData.photos[item.name] && formData.photos[item.name].length > 0) {
                        yPosition += 2;
                        for (const photoData of formData.photos[item.name]) {
                            checkAddPage(60);
                            try {
                                doc.addImage(photoData, 'JPEG', margin + 2, yPosition, 50, 50);
                                yPosition += 52;
                            } catch (e) {
                                console.error('Error adding image:', e);
                            }
                        }
                    }
                    yPosition += 3;
                }
                
                yPosition += 5;
                
                // Section: Furniture
                checkAddPage(30);
                doc.setFontSize(14);
                doc.setTextColor(139, 0, 0);
                doc.text('Furniture', margin, yPosition);
                yPosition += 8;
                
                doc.setFontSize(10);
                doc.setTextColor(0, 0, 0);
                
                const furnitureItems = [
                    { label: 'Bed', name: 'furniture_bed', remarks: 'furniture_bed_remarks' },
                    { label: 'Desk', name: 'furniture_desk', remarks: 'furniture_desk_remarks' },
                    { label: 'Chair', name: 'furniture_chair', remarks: 'furniture_chair_remarks' },
                    { label: 'Wardrobe', name: 'furniture_wardrobe', remarks: 'furniture_wardrobe_remarks' }
                ];
                
                for (const item of furnitureItems) {
                    checkAddPage(15);
                    doc.text(`‚Ä¢ ${item.label}: ${getRadioValue(item.name)}`, margin + 2, yPosition);
                    yPosition += 5;
                    const remarks = getFormValue(item.remarks);
                    if (remarks) {
                        doc.setFontSize(9);
                        doc.setTextColor(80, 80, 80);
                        const lines = doc.splitTextToSize(`  Remark: ${remarks}`, contentWidth - 5);
                        doc.text(lines, margin + 2, yPosition);
                        yPosition += lines.length * 4;
                        doc.setFontSize(10);
                        doc.setTextColor(0, 0, 0);
                    }
                    
                    if (formData.photos[item.name] && formData.photos[item.name].length > 0) {
                        yPosition += 2;
                        for (const photoData of formData.photos[item.name]) {
                            checkAddPage(60);
                            try {
                                doc.addImage(photoData, 'JPEG', margin + 2, yPosition, 50, 50);
                                yPosition += 52;
                            } catch (e) {
                                console.error('Error adding image:', e);
                            }
                        }
                    }
                    yPosition += 3;
                }
                
                yPosition += 5;
                
                // Section: Common Areas
                checkAddPage(30);
                doc.setFontSize(14);
                doc.setTextColor(139, 0, 0);
                doc.text('Common Areas', margin, yPosition);
                yPosition += 8;
                
                doc.setFontSize(10);
                doc.setTextColor(0, 0, 0);
                
                const commonItems = [
                    { label: 'Kitchen', name: 'common_kitchen', remarks: 'common_kitchen_remarks' },
                    { label: 'Bathroom', name: 'common_bathroom', remarks: 'common_bathroom_remarks' },
                    { label: 'Hallway', name: 'common_hallway', remarks: 'common_hallway_remarks' }
                ];
                
                for (const item of commonItems) {
                    checkAddPage(15);
                    doc.text(`‚Ä¢ ${item.label}: ${getRadioValue(item.name)}`, margin + 2, yPosition);
                    yPosition += 5;
                    const remarks = getFormValue(item.remarks);
                    if (remarks) {
                        doc.setFontSize(9);
                        doc.setTextColor(80, 80, 80);
                        const lines = doc.splitTextToSize(`  Remark: ${remarks}`, contentWidth - 5);
                        doc.text(lines, margin + 2, yPosition);
                        yPosition += lines.length * 4;
                        doc.setFontSize(10);
                        doc.setTextColor(0, 0, 0);
                    }
                    
                    if (formData.photos[item.name] && formData.photos[item.name].length > 0) {
                        yPosition += 2;
                        for (const photoData of formData.photos[item.name]) {
                            checkAddPage(60);
                            try {
                                doc.addImage(photoData, 'JPEG', margin + 2, yPosition, 50, 50);
                                yPosition += 52;
                            } catch (e) {
                                console.error('Error adding image:', e);
                            }
                        }
                    }
                    yPosition += 3;
                }
                
                yPosition += 5;
                
                // Section: Keys
                checkAddPage(20);
                doc.setFontSize(14);
                doc.setTextColor(139, 0, 0);
                doc.text('Keys', margin, yPosition);
                yPosition += 8;
                
                doc.setFontSize(10);
                doc.setTextColor(0, 0, 0);
                const keysDetails = getFormValue('keys_details');
                if (keysDetails) {
                    const lines = doc.splitTextToSize(keysDetails, contentWidth);
                    doc.text(lines, margin + 2, yPosition);
                    yPosition += lines.length * 5;
                }
                
                if (formData.photos['keys'] && formData.photos['keys'].length > 0) {
                    yPosition += 2;
                    for (const photoData of formData.photos['keys']) {
                        checkAddPage(60);
                        try {
                            doc.addImage(photoData, 'JPEG', margin + 2, yPosition, 50, 50);
                            yPosition += 52;
                        } catch (e) {
                            console.error('Error adding image:', e);
                        }
                    }
                }
                
                yPosition += 5;
                
                // Section: Meter Readings
                checkAddPage(20);
                doc.setFontSize(14);
                doc.setTextColor(139, 0, 0);
                doc.text('Meter Readings', margin, yPosition);
                yPosition += 8;
                
                doc.setFontSize(10);
                doc.setTextColor(0, 0, 0);
                
                const meterElectricity = getFormValue('meter_electricity');
                if (meterElectricity) {
                    doc.text(`Electricity: ${meterElectricity}`, margin + 2, yPosition);
                    yPosition += 5;
                }
                
                if (formData.photos['meter_electricity'] && formData.photos['meter_electricity'].length > 0) {
                    yPosition += 2;
                    for (const photoData of formData.photos['meter_electricity']) {
                        checkAddPage(60);
                        try {
                            doc.addImage(photoData, 'JPEG', margin + 2, yPosition, 50, 50);
                            yPosition += 52;
                        } catch (e) {
                            console.error('Error adding image:', e);
                        }
                    }
                }
                
                yPosition += 5;
                
                const meterWater = getFormValue('meter_water');
                if (meterWater) {
                    checkAddPage(10);
                    doc.text(`Water: ${meterWater}`, margin + 2, yPosition);
                    yPosition += 5;
                }
                
                if (formData.photos['meter_water'] && formData.photos['meter_water'].length > 0) {
                    yPosition += 2;
                    for (const photoData of formData.photos['meter_water']) {
                        checkAddPage(60);
                        try {
                            doc.addImage(photoData, 'JPEG', margin + 2, yPosition, 50, 50);
                            yPosition += 52;
                        } catch (e) {
                            console.error('Error adding image:', e);
                        }
                    }
                }
                
                yPosition += 10;
                
                // Section: Unterschriften
                checkAddPage(80);
                doc.setFontSize(14);
                doc.setTextColor(139, 0, 0);
                doc.text('Unterschriften', margin, yPosition);
                yPosition += 10;
                
                doc.setFontSize(10);
                doc.setTextColor(0, 0, 0);
                
                // Outgoing tenant signature
                doc.text('Outgoing Tenant:', margin, yPosition);
                yPosition += 5;
                doc.text(getFormValue('name_outgoing'), margin, yPosition);
                yPosition += 5;
                
                const sigOutgoingData = sigOutgoing.toDataURL('image/png');
                doc.addImage(sigOutgoingData, 'PNG', margin, yPosition, 60, 20);
                yPosition += 25;
                
                // Incoming tenant signature
                doc.text('Incoming Tenant:', margin, yPosition);
                yPosition += 5;
                doc.text(getFormValue('name_incoming'), margin, yPosition);
                yPosition += 5;
                
                const sigIncomingData = sigIncoming.toDataURL('image/png');
                doc.addImage(sigIncomingData, 'PNG', margin, yPosition, 60, 20);
                yPosition += 25;
                
                // Date
                doc.text(`Date: ${getFormValue('handover_date')}`, margin, yPosition);
                
                // Save PDF
                const filename = `Uebergabeprotokoll_${getFormValue('property_address').replace(/[^a-zA-Z0-9]/g, '_')}_${getFormValue('handover_date')}.pdf`;
                doc.save(filename);
                
                // Show success message
                progress.style.display = 'none';
                success.style.display = 'block';
                
                const emails = [
                    getFormValue('email_outgoing'),
                    getFormValue('email_incoming'),
                    getFormValue('email_landlord')
                ].filter(e => e).join(', ');
                
                document.getElementById('emailList').textContent = emails;
                
            } catch (error) {
                console.error('PDF generation error:', error);
                alert('Error creating PDF: ' + error.message);
                progress.style.display = 'none';
            }
            
            btn.disabled = false;
        }
        
        // Auto-save to localStorage
        document.addEventListener('input', function(e) {
            if (e.target.id) {
                localStorage.setItem('en_' + e.target.id, e.target.value);
            }
        });
        
        // Load from localStorage
        window.addEventListener('load', function() {
            document.querySelectorAll('input[type="text"], input[type="email"], input[type="date"], textarea').forEach(element => {
                const saved = localStorage.getItem('en_' + element.id);
                if (saved && element.id !== 'email_landlord') {
                    element.value = saved;
                }
            });
            
            document.querySelectorAll('input[type="radio"]').forEach(radio => {
                const saved = localStorage.getItem('en_' + radio.name);
                if (saved === radio.value) {
                    radio.checked = true;
                    radio.parentElement.classList.add('checked');
                    if (radio.name === 'property_type' && radio.value === 'Room') {
                        toggleRoomNumber(true);
                    }
                }
            });
        });
    </script>
</body>
</html>
